when call merg environ set as document in an except occur there appear to be a conflict between the code and the expect result call merg environ set on a session object with none in all argument except the first proce without actual result an except occur nonetyp object ha no attribut setdefault thi is caus by when the proxi argument is set to reproduct step as per the document exampl python from request import request session s session url request get url prep none none none none system inform python xenial,documentation
i get encod issu when extract text from some url for exampl thi after some dig it seem that although the header dictionari is case insensit the pars of the content type header entri is not for exampl if the server send text html charset utf becaus of the uppercas c return the default iso instead of expect should return utf as it is state in the content type actual return the reproduct step python import request resp system inform python m chardet version cryptographi version idna version implement name cpython version platform releas system darwin pyopenssl openssl version version null request version system ssl version ff urllib version use pyopenssl fals suggest the code respons is in method pars content type header here either use a case insensit dictionari or transform the key to lowercas valu,bug
when access a page that is not redirect properli in thi case port is urllib locationparseerror is return without be caught by request the url current jul rd badli redirect expect result an except rais by request like invalidurl actual result except from urllib is not mask reproduct step python import request test most recent call last file line in file line in get return request get url param param kwarg file line in request return url url kwarg file line in request resp send kwarg file line in send histori resp for resp in gen if allow redirect els file line in resolv redirect adapt kwarg file line in send r kwarg file line in send conn proxi file line in get connect conn file line in connect from url u pars url url file line in pars url rais fail to pars system inform python m chardet version cryptographi version idna version implement name cpython version platform releas system linux pyopenssl openssl version f version request version system ssl version f urllib version use pyopenssl true,bug
thi may be consid intent behaviour in which case feel free to close thi but if a request is made to an http endpoint with author and it redirect to http on the same host the author header is not strip and will be expos on the expect result rebuild auth would strip the author header if the scheme is chang from http to actual result the credenti that were intend to be sent over tl were transmit in plaintext with the redirect reproduct step run an http server on localhost that repli with a redirect to http localhost and a plain http server or netcat on localhost then run python import auth hello world verifi fals the basic auth credenti are sent in plaintext to http localhost the verifi fals is just becaus i had a self sign the code i use for the ssl server python import basehttpserv import ssl class def do get self http localhost server side true system inform chardet version cryptographi version idna version implement name cpython version platform releas system linux pyopenssl openssl version f version request version system ssl version f urllib version use pyopenssl true,bug
summari curl s url data method help work usr bin env python import request import json payload method help url header content type text plain charset utf use usr bin env python instead and it doesn t work anymor request mess thing expect result work as curl and request in python do actual result request in python mess with reproduct step python import request import json payload method help url header content type text plain charset utf system inform python,bug
in the follow case see detail explan and test case at tri to open a link that contain a fragment say http foo someinfo the server send a redir to http bar expect result the expect result is that request librari follow the redirect and append the origin fragment from the link it redirect to http bar someinfo actual result the redirect link is follow without the fragment request tri to open http bar reproduct step python import request respons is should be system inform python m chardet version cryptographi version idna version implement name cpython version platform releas system window pyopenssl openssl version version null request version system ssl version bf urllib version use pyopenssl fals thi command is onli avail on request and greater otherwis pleas provid some basic inform about your system python version oper system c,bug
